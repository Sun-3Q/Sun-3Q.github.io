<template>
  <div class="page-footer-stats">
    <div class="stats-container">
      <span class="stat-item">
        <span class="icon">ğŸŒ</span>
        <span>æœ¬ç«™æ€»è®¿é—®é‡</span>
        <span id="busuanzi_value_site_pv" class="stat-value">--</span>
        <span>æ¬¡</span>
      </span>
      <span class="stat-divider">|</span>
      <span class="stat-item">
        <span class="icon">ğŸ‘¤</span>
        <span>æœ¬ç«™è®¿å®¢æ•°</span>
        <span id="busuanzi_value_site_uv" class="stat-value">--</span>
        <span>äºº</span>
      </span>
      <span class="stat-divider">|</span>
      <span class="stat-item">
        <span class="icon">ğŸ“„</span>
        <span>æœ¬é¡µé˜…è¯»é‡</span>
        <span id="busuanzi_value_page_pv" class="stat-value">--</span>
        <span>æ¬¡</span>
      </span>
    </div>
  </div>
</template>

<script setup lang="ts">
import { onMounted, onUnmounted } from 'vue'

let scriptElement: HTMLScriptElement | null = null

const loadBusuanzi = () => {
  // æ£€æŸ¥è„šæœ¬æ˜¯å¦å·²ç»åŠ è½½
  if (document.getElementById('busuanzi_script')) {
    return
  }

  // åˆ›å»º script æ ‡ç­¾
  scriptElement = document.createElement('script')
  scriptElement.id = 'busuanzi_script'
  scriptElement.async = true
  scriptElement.src = '//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js'
  document.body.appendChild(scriptElement)
}

onMounted(() => {
  loadBusuanzi()
})

onUnmounted(() => {
  // æ¸…ç†è„šæœ¬
  if (scriptElement && scriptElement.parentNode) {
    scriptElement.parentNode.removeChild(scriptElement)
    scriptElement = null
  }
})
</script>

<style scoped>
.page-footer-stats {
  padding: 24px 0;
  margin-top: 48px;
  border-top: 1px solid var(--vp-c-divider);
  text-align: center;
  font-size: 14px;
  color: var(--vp-c-text-2);
}

.stats-container {
  display: flex;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
  gap: 8px;
}

.stat-item {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 4px 8px;
}

.stat-item .icon {
  font-size: 16px;
}

.stat-value {
  font-weight: 600;
  color: var(--vp-c-brand-1);
  margin: 0 2px;
}

.stat-divider {
  color: var(--vp-c-divider);
  margin: 0 4px;
}

@media (max-width: 768px) {
  .page-footer-stats {
    font-size: 12px;
    padding: 16px 0;
    margin-top: 32px;
  }
  
  .stats-container {
    flex-direction: column;
    gap: 12px;
  }
  
  .stat-divider {
    display: none;
  }
  
  .stat-item {
    justify-content: center;
  }
}
</style>
